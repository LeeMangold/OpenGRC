# ModSecurity WAF Configuration for Apache
# This file is included when WAF_ENABLED=true (default)

<IfModule security2_module>
    # Include ModSecurity base configuration
    Include /etc/modsecurity/modsecurity.conf

    # Include CRS setup
    Include /etc/modsecurity/crs-setup.conf

    # Include OWASP CRS rules
    Include /usr/share/modsecurity-crs/rules/*.conf

    # Include Laravel-specific exclusions (MUST be after CRS rules)
    Include /etc/modsecurity/laravel-exclusions.conf

    # Create ModSecurity temporary directories
    <Directory /tmp/modsecurity>
        Options -Indexes
        Require all denied
    </Directory>
</IfModule>
