# Apache Access Log Parser
# Parses Apache Combined Log Format
# Format: IP - user [time] "METHOD /path HTTP/version" status bytes "referrer" "user-agent"

[PARSER]
    Name   apache
    Format regex
    Regex  ^(?<client_ip>[^ ]*) [^ ]* (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<http_method>\S+)(?: +(?<url>[^\"]*?)(?: +(?<http_version>\S+))?)?" (?<response_code>[^ ]*) (?<bytes>[^ ]*)(?: "(?<referrer>[^\"]*)" "(?<user_agent>[^\"]*)")?$
    Time_Key time
    Time_Format %d/%b/%Y:%H:%M:%S %z

# Laravel Log Parser
# Parses Laravel log format with JSON context
# Format: [timestamp] environment.LEVEL: message {json_context}

[PARSER]
    Name   laravel
    Format regex
    Regex  ^\[(?<time>[^\]]+)\] (?<environment>\w+)\.(?<level>\w+): (?<message>[^{]*?)(?<context>\{.*\})?$
    Time_Key time
    Time_Format %Y-%m-%d %H:%M:%S