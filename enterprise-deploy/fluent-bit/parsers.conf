# Apache Access Log Parser
# Parses Apache Combined Log Format
# Format: IP - user [time] "METHOD /path HTTP/version" status bytes "referrer" "user-agent"

[PARSER]
    Name   apache
    Format regex
    Regex  ^(?<client_ip>[^ ]*) [^ ]* (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<http_method>\S+)(?: +(?<url>[^\"]*?)(?: +(?<http_version>\S+))?)?" (?<response_code>[^ ]*) (?<bytes>[^ ]*)(?: "(?<referrer>[^\"]*)" "(?<user_agent>[^\"]*)")?$
    Time_Key time
    Time_Format %d/%b/%Y:%H:%M:%S %z